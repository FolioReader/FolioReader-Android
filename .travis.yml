language: android

before_install:
  - echo yes | android update sdk --filter extra-android-support --no-ui --force > /dev/null
  - echo yes | android update sdk --filter extra-android-m2repository --no-ui --force > /dev/null
  - yes | sdkmanager "platforms;android-28"

android:
  components:
    # https://docs.travis-ci.com/user/languages/android/#Installing-a-newer-SDK-Platform-Tools-revision
    - tools
    - platform-tools
    - tools

    # The BuildTools version used by your project
    - build-tools-27.0.3

    - android-28
    - extra-android-m2repository
    - sys-img-x86-android-28

  licenses:
      - android-sdk-preview-license-.+
      - android-sdk-license-.+

  before_script:
    - echo no | android create avd --force -n test -t android-28 --abi armeabi-v7a
    - emulator -avd test -no-audio -no-window &
    - android-wait-for-emulator
    - adb shell input keyevent 82 &

  script:
    ./gradlew build